import matplotlib.pyplot as plt
import numpy as np
import math

"""
tanh is popular in bounded saturation algorithms, but is also
seen in calculating filter coefficients (and also AI).

In generating filter coefficients, high accuracy is needed
else the cutoff could be too far from it's desired position.
This makes the pad√© algorithm a great choice

In sturation, destroying signals is often a good thing, and
the signal is often boosten to the nth degree. Each of the
functions gain precision the greater the input signal. This
makes the super fast and generally accurate exp_schraudolph
a great choice. exp_ekmett_ub may be preferable however
because it is more accurate at 0

The following table compares the speed and error margin of
different tanh approxiamtions used in the following formula:
    tanh(x)

SEC      xSPEED ERROR     NAME
0.055509                  pass
0.157988        0         stl
0.096117 2.52   0.000025  exp_mineiro
0.087596 3.19   0.0000007 c3
0.080004 4.18   0         pade
0.079603 4.25   0.008     exp_mineiro_faster
0.078102 4.53   0.025     exp_ekmett_ub      -- only super fast algo to accurately produce 0
0.077790 4.59   0.02      exp_ekmett_lb
0.077662 4.62   0.008     exp_schraudolph

- pass = no processing
- stl = tanh(x)
- xSpeed of the tanh function calculated: (stl - pass) / (other_sec - pass)
- Error is is taken at the worst point. Often around 0 - 0.3
"""

stl = [-0.999329328537,-0.999180853367,-0.998999595642,-0.998778223991,-0.998507916927,-0.998177886009,-0.997774899006,-0.997282981873,-0.996682405472,-0.995949387550,-0.995054781437,-0.993963181973,-0.992631494999,-0.991007447243,-0.989027380943,-0.986614286900,-0.983674883842,-0.980096399784,-0.975743114948,-0.970451951027,-0.964027583599,-0.956237435341,-0.946806013584,-0.935409069061,-0.921668589115,-0.905148267746,-0.885351657867,-0.861723124981,-0.833654642105,-0.800499022007,-0.761594176292,-0.716297864914,-0.664036750793,-0.604367792606,-0.537049591541,-0.462117165327,-0.379948973656,-0.291312634945,-0.197375327349,-0.099667996168,0.000000000000,0.099667996168,0.197375327349,0.291312634945,0.379948973656,0.462117165327,0.537049591541,0.604367792606,0.664036750793,0.716297864914,0.761594176292,0.800499022007,0.833654642105,0.861723124981,0.885351657867,0.905148267746,0.921668589115,0.935409069061,0.946806013584,0.956237435341,0.964027583599,0.970451951027,0.975743114948,0.980096399784,0.983674883842,0.986614286900,0.989027380943,0.991007447243,0.992631494999,0.993963181973,0.995054781437,0.995949387550,0.996682405472,0.997282981873,0.997774899006,0.998177886009,0.998507916927,0.998778223991,0.998999595642,0.999180853367,0.999329328537,]
pade = [-0.999344229698,-0.999192714691,-0.999009013176,-0.998785495758,-0.998513579369,-0.998182237148,-0.997778236866,-0.997285306454,-0.996684134007,-0.995950579643,-0.995055675507,-0.993963778019,-0.992631971836,-0.991007685661,-0.989027678967,-0.986614465714,-0.983674943447,-0.980096399784,-0.975743174553,-0.970451951027,-0.964027583599,-0.956237435341,-0.946805953979,-0.935409128666,-0.921668589115,-0.905148267746,-0.885351657867,-0.861723184586,-0.833654642105,-0.800499022007,-0.761594176292,-0.716297805309,-0.664036810398,-0.604367792606,-0.537049591541,-0.462117165327,-0.379949003458,-0.291312634945,-0.197375327349,-0.099667988718,0.000000000000,0.099667988718,0.197375327349,0.291312634945,0.379949003458,0.462117165327,0.537049591541,0.604367792606,0.664036810398,0.716297805309,0.761594176292,0.800499022007,0.833654642105,0.861723184586,0.885351657867,0.905148267746,0.921668589115,0.935409128666,0.946805953979,0.956237435341,0.964027583599,0.970451951027,0.975743174553,0.980096399784,0.983674943447,0.986614465714,0.989027678967,0.991007685661,0.992631971836,0.993963778019,0.995055675507,0.995950579643,0.996684134007,0.997285306454,0.997778236866,0.998182237148,0.998513579369,0.998785495758,0.999009013176,0.999192714691,0.999344229698,]
c3 = [-0.999329209328,-0.999180793762,-0.998999536037,-0.998778283596,-0.998507916927,-0.998177886009,-0.997774958611,-0.997282922268,-0.996682405472,-0.995949327946,-0.995054721832,-0.993963241577,-0.992631614208,-0.991007447243,-0.989027500153,-0.986614406109,-0.983674943447,-0.980096399784,-0.975743055344,-0.970451951027,-0.964027464390,-0.956237375736,-0.946806073189,-0.935409247875,-0.921668648720,-0.905148208141,-0.885351717472,-0.861722886562,-0.833654642105,-0.800499498844,-0.761594653130,-0.716298043728,-0.664036810398,-0.604367733002,-0.537048816681,-0.462117373943,-0.379950076342,-0.291313588619,-0.197375774384,-0.099668070674,0.000000000000,0.099668070674,0.197375774384,0.291313588619,0.379950076342,0.462117373943,0.537048816681,0.604367733002,0.664036810398,0.716298043728,0.761594653130,0.800499498844,0.833654642105,0.861722886562,0.885351717472,0.905148208141,0.921668648720,0.935409247875,0.946806073189,0.956237375736,0.964027464390,0.970451951027,0.975743055344,0.980096399784,0.983674943447,0.986614406109,0.989027500153,0.991007447243,0.992631614208,0.993963241577,0.995054721832,0.995949327946,0.996682405472,0.997282922268,0.997774958611,0.998177886009,0.998507916927,0.998778283596,0.998999536037,0.999180793762,0.999329209328,]
exp_ekmett_ub = [-0.999366700649,-0.999220907688,-0.999006271362,-0.998835265636,-0.998593211174,-0.998224198818,-0.997844576836,-0.997436404228,-0.996837556362,-0.995990753174,-0.995293915272,-0.994303822517,-0.992786169052,-0.991311550140,-0.989651143551,-0.987206101418,-0.983896434307,-0.981083810329,-0.977080702782,-0.970928907394,-0.965316951275,-0.958704710007,-0.948977291584,-0.936473011971,-0.925556361675,-0.910109400749,-0.886575102806,-0.866738259792,-0.842516064644,-0.807534635067,-0.765850901604,-0.729268431664,-0.679141461849,-0.606229543686,-0.551817059517,-0.485249280930,-0.395463407040,-0.302069723606,-0.223927795887,-0.126078903675,0.000000000000,0.077741861343,0.168592810631,0.276167750359,0.368494391441,0.439546823502,0.518381476402,0.603170275688,0.650899052620,0.701557040215,0.755423665047,0.795123338699,0.824658393860,0.855180740356,0.884544730186,0.900693893433,0.917121767998,0.933836579323,0.945102572441,0.953668713570,0.962310791016,0.970129847527,0.974514126778,0.978918313980,0.983341932297,0.986139416695,0.988365054131,0.990595698357,0.992524504662,0.993643760681,0.994764447212,0.995886206627,0.996555328369,0.997116923332,0.997679114342,0.998145103455,0.998426437378,0.998707890511,0.998989343643,0.999147295952,0.999288082123,]
exp_ekmett_lb = [-0.999329268932,-0.999163508415,-0.998960733414,-0.998772263527,-0.998500227928,-0.998073399067,-0.997737109661,-0.997282922268,-0.996600687504,-0.995805442333,-0.995036542416,-0.993922412395,-0.992190718651,-0.990874826908,-0.989025473595,-0.986235976219,-0.983149051666,-0.980044066906,-0.975536346436,-0.968820154667,-0.963577210903,-0.956214547157,-0.945121049881,-0.933566868305,-0.921534061432,-0.904178142548,-0.879719555378,-0.860329926014,-0.833487510681,-0.793875634670,-0.756016194820,-0.716033756733,-0.660382449627,-0.589103102684,-0.533833622932,-0.461384832859,-0.362279355526,-0.280456721783,-0.197111189365,-0.091925024986,0.021991968155,0.103329896927,0.198737025261,0.312202811241,0.388945460320,0.462194204330,0.543598890305,0.617117166519,0.665692687035,0.717276692390,0.772159218788,0.803833365440,0.833658099174,0.864484786987,0.889333367348,0.905565023422,0.922077655792,0.938879370689,0.947650074959,0.956238746643,0.964903712273,0.971435546875,0.975825905800,0.980235934258,0.984580874443,0.986802935600,0.989029884338,0.991261959076,0.992858290672,0.993978142738,0.995098948479,0.996161222458,0.996722817421,0.997284770012,0.997846722603,0.998229146004,0.998510241508,0.998791694641,0.999048709869,0.999189257622,0.999330043793,]
exp_schraudolph = [-0.999341964722,-0.999183177948,-0.998976051807,-0.998793601990,-0.998531937599,-0.998125314713,-0.997773349285,-0.997335016727,-0.996681809425,-0.995867788792,-0.995123565197,-0.994052410126,-0.992378115654,-0.991022109985,-0.989237844944,-0.986568391323,-0.983400464058,-0.980395734310,-0.976062715054,-0.969271421432,-0.964163839817,-0.957059562206,-0.946442127228,-0.934544086456,-0.922893762589,-0.906198143959,-0.881323516369,-0.862488031387,-0.836545765400,-0.798541665077,-0.759315431118,-0.720493018627,-0.666741251945,-0.593791842461,-0.539859294891,-0.469412863255,-0.373502731323,-0.287656068802,-0.206064522266,-0.103361248970,0.014709115028,0.094846367836,0.188729643822,0.300220727921,0.382204174995,0.454725027084,0.535277366638,0.612538933754,0.660835504532,0.712114572525,0.766662478447,0.800981521606,0.830711245537,0.861438035965,0.887767910957,0.903972506523,0.920457482338,0.937230706215,0.946817994118,0.955399274826,0.964056730270,0.971009373665,0.975397586823,0.979805707932,0.984233260155,0.986586332321,0.988812923431,0.991044521332,0.992749333382,0.993868827820,0.994989871979,0.996106624603,0.996668219566,0.997230052948,0.997792005539,0.998201608658,0.998482942581,0.998764276505,0.999034881592,0.999175667763,0.999316453934,]
exp_mineiro = [-0.999329328537,-0.999180853367,-0.998999595642,-0.998778223991,-0.998507916927,-0.998177826405,-0.997774839401,-0.997282981873,-0.996682286263,-0.995949268341,-0.995054662228,-0.993963122368,-0.992631196976,-0.991007149220,-0.989027500153,-0.986613869667,-0.983674407005,-0.980096220970,-0.975742936134,-0.970450758934,-0.964026629925,-0.956237912178,-0.946803808212,-0.935407042503,-0.921667635441,-0.905146777630,-0.885348021984,-0.861719727516,-0.833656549454,-0.800491929054,-0.761584997177,-0.716296792030,-0.664031624794,-0.604361116886,-0.537041068077,-0.462118685246,-0.379934132099,-0.291293919086,-0.197374224663,-0.099653482437,0.000000000000,0.099678039551,0.197376370430,0.291337013245,0.379966735840,0.462116718292,0.537059783936,0.604368567467,0.664041876793,0.716298460960,0.761605024338,0.800505280495,0.833654880524,0.861728072166,0.885352849960,0.905150055885,0.921669006348,0.935412049294,0.946807861328,0.956237316132,0.964029073715,0.970452427864,0.975743532181,0.980096578598,0.983675360680,0.986614823341,0.989027500153,0.991007924080,0.992631793022,0.993963122368,0.995054841042,0.995949387550,0.996682405472,0.997282862663,0.997774958611,0.998178005219,0.998507857323,0.998778343201,0.998999595642,0.999180912971,0.999329328537,]
exp_mineiro_faster = [-0.999342262745,-0.999183595181,-0.998976409435,-0.998794078827,-0.998532652855,-0.998126566410,-0.997774183750,-0.997336208820,-0.996683716774,-0.995869278908,-0.995125591755,-0.994055509567,-0.992383241653,-0.991025567055,-0.989242792130,-0.986576318741,-0.983406364918,-0.980403959751,-0.976075351238,-0.969291687012,-0.964177668095,-0.957079827785,-0.946473598480,-0.934567093849,-0.922926366329,-0.906246423721,-0.881361365318,-0.862538814545,-0.836619079113,-0.798650622368,-0.759393215179,-0.720600247383,-0.666890323162,-0.593902587891,-0.540004611015,-0.469606101513,-0.373766124249,-0.287828266621,-0.206278443336,-0.103634119034,0.014534354210,0.094642996788,0.188489794731,0.299933791161,0.382042050362,0.454545497894,0.535077333450,0.612428545952,0.660718441010,0.711990118027,0.766530036926,0.800912618637,0.830640077591,0.861364603043,0.887730002403,0.903934121132,0.920418262482,0.937190890312,0.946797847748,0.955379009247,0.964036226273,0.970999002457,0.975387334824,0.979795217514,0.984222888947,0.986581087112,0.988807678223,0.991039037704,0.992746710777,0.993866205215,0.994987249374,0.996105194092,0.996666789055,0.997228622437,0.997790813446,0.998201131821,0.998482465744,0.998763561249,0.999034643173,0.999175429344,0.999315977097,]


x_labels = [
    -4.0, -3.9, -3.8, -3.7, -3.6, -3.5, -3.4, -3.3, -3.2, -3.1,
    -3.0, -2.9, -2.8, -2.7, -2.6, -2.5, -2.4, -2.3, -2.2, -2.1,
    -2.0, -1.9, -1.8, -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1,
    -1.0, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1,
    0.0,  0.1,  0.2,  0.3,  0.4,  0.5,  0.6,  0.7,  0.8,  0.9,
    1.0,  1.1,  1.2,  1.3,  1.4,  1.5,  1.6,  1.7,  1.8,  1.9,
    2.0,  2.1,  2.2,  2.3,  2.4,  2.5,  2.6,  2.7,  2.8,  2.9,
    3.0,  3.1,  3.2,  3.3,  3.4,  3.5,  3.6,  3.7,  3.8,  3.9,
    4.0,
]

class Styles:
    idx = 0
    types = ['solid', 'dotted', 'dashed', 'dashdot']

    def get(self):
        s = self.types[self.idx]
        self.idx = (self.idx + 1) & 3
        return s

linestyles = Styles()

fig, ax = plt.subplots()

x_ticks = [i for i in range(len(x_labels))]
x = [i for i in range(len(stl))]

# plt.xlabel('phase 0-1')
plt.xticks(ticks=x_ticks, labels=x_labels)
# plt.ylabel('mag')

ax.plot(stl, label='stl', linestyle=linestyles.get())
# ax.plot(pade, label='pade', linestyle=linestyles.get())
# ax.plot(c3, label='c3', linestyle=linestyles.get())
ax.plot(exp_ekmett_ub, label='exp_ekmett_ub', linestyle=linestyles.get())
ax.plot(exp_ekmett_lb, label='exp_ekmett_lb', linestyle=linestyles.get())
ax.plot(exp_schraudolph, label='exp_schraudolph', linestyle=linestyles.get())
# ax.plot(exp_mineiro, label='exp_mineiro', linestyle=linestyles.get())
ax.plot(exp_mineiro_faster, label='exp_mineiro_faster', linestyle=linestyles.get())


ax.legend()
plt.show()
